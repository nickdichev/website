@font-face {
  font-family: "Righteous";
  src: url("/fonts/Righteous.eot");
  src:
    url("/fonts/Righteous.eot?#iefix") format("embedded-opentype"),
    url("/fonts/Righteous.woff2") format("woff2"),
    url("/fonts/Righteous.woff") format("woff"),
    url("/fonts/Righteous.ttf") format("truetype"),
    url("/fonts/Righteous.svg#Righteous") format("svg");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* Primitive Colors (RGB format for Tailwind alpha support) */
:root {
  /* Warm neutrals - Light */
  --color-warm-50: 250 250 249;
  --color-warm-100: 242 240 237;
  --color-warm-200: 230 226 220;
  --color-warm-300: 200 195 188;
  --color-warm-400: 160 154 146;
  --color-warm-500: 120 114 106;
  --color-warm-600: 87 83 78;
  --color-warm-700: 51 65 85;
  /* Warm neutrals - Dark */
  --color-warm-800: 55 50 45;
  --color-warm-850: 40 36 33;
  --color-warm-900: 28 25 23;
  --color-warm-950: 20 18 16;
  --color-warm-text-dark: 220 215 210;
  /* Primary - Orange/Red */
  --color-primary-light: 195 75 34;
  --color-primary-light-hover: 165 60 25;
  --color-primary-dark: 226 112 54;
  --color-primary-dark-hover: 240 130 70;
  /* Secondary - Orange/Brown */
  --color-secondary-light: 198 140 83;
  --color-secondary-dark: 209 162 97;
  /* Accent - Green */
  --color-accent-light: 53 140 97;
  --color-accent-light-hover: 40 115 78;
  --color-accent-dark: 64 191 127;
  --color-accent-dark-hover: 80 210 145;
  /* Warning */
  --color-warning: 245 158 11;
}

/* Semantic Tokens - Light Mode */
:root {
  --color-background: var(--color-warm-50);
  --color-surface: var(--color-warm-100);
  --color-surface-hover: var(--color-warm-200);
  --color-text-primary: var(--color-warm-700);
  --color-text-secondary: var(--color-warm-500);
  --color-text-heading: 41 37 36;
  --color-text-hover: var(--color-primary-light);
  --color-text-inverse: 255 255 255;
  --color-accent: var(--color-primary-light);
  --color-accent-light: var(--color-secondary-light);
  --color-accent-hover: var(--color-primary-light-hover);
  --color-brand: var(--color-primary-light);
  --color-border: var(--color-warm-300);
  --color-badge-warning: var(--color-warning);
  --color-indicator-active: var(--color-accent-light);
  --color-indicator-default: 41 37 36;
  --color-code-bg: var(--color-warm-950);
  --color-code-text: var(--color-warm-text-dark);
  --color-code-button: var(--color-warm-850);
  --color-code-button-hover: var(--color-warm-800);
  --color-code-line-number: var(--color-warm-400);
  --color-tag: var(--color-warm-100);
  --color-tag-hover: var(--color-warm-200);
}

/* Semantic Tokens - Dark Mode */
.dark {
  --color-background: var(--color-warm-900);
  --color-surface: var(--color-warm-850);
  --color-surface-hover: var(--color-warm-800);
  --color-text-primary: var(--color-warm-text-dark);
  --color-text-heading: 250 248 245;
  --color-text-hover: var(--color-primary-dark);
  --color-accent: var(--color-primary-dark);
  --color-accent-light: var(--color-secondary-dark);
  --color-accent-hover: var(--color-primary-dark-hover);
  --color-brand: var(--color-primary-dark);
  --color-border: var(--color-warm-600);
  --color-indicator-active: var(--color-accent-dark);
  --color-indicator-default: 250 248 245;
  --color-tag: var(--color-warm-800);
  --color-tag-hover: var(--color-warm-600);
}

figure[data-rehype-pretty-code-figure] {
  @apply space-y-0;
}

figure[data-rehype-pretty-code-figure] pre {
  @apply p-0 py-2 rounded-t-none rounded-lg overflow-x-auto bg-code-bg;
}

figure[data-rehype-pretty-code-figure] code {
  counter-reset: line;
}

span[data-line]::before {
  counter-increment: line;
  content: counter(line);
  @apply px-3 border-l-4 border-transparent text-code-line-number;
}

span[data-line] {
  @apply flex;
}

span[data-highlighted-line]::before {
  @apply border-accent-light;
}

span[data-highlighted-line] {
  @apply bg-accent-light/20;
}

/* Blog post body background for readability over lava lamp */
.blog-post-body .article-with-asides {
  background-color: rgb(var(--color-background) / 0.80);
  border-radius: 0.75rem;
  padding: 2rem;
}

/* Aside Design Tokens */
:root {
  --color-aside-bg: var(--color-warm-100);
  --color-aside-border: var(--color-warm-300);
  --color-aside-marker: var(--color-primary-light);
}

.dark {
  --color-aside-bg: var(--color-warm-850);
  --color-aside-border: var(--color-warm-600);
  --color-aside-marker: var(--color-primary-dark);
}

/* Aside Container - Force inline */
.aside-container {
  display: inline !important;
}

/* Aside Marker Wrapper - Keeps marker inline with text */
.aside-marker-wrapper {
  display: inline;
}

/* Aside Marker - Inline-flex for icon alignment, no border */
.aside-marker {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: middle;
  background-color: rgb(var(--color-aside-marker) / 0.15);
  color: rgb(var(--color-aside-marker));
  border-radius: 0.25rem;
  padding: 0.125rem 0.375rem;
  font-size: 0.75rem;
  font-weight: 600;
  cursor: pointer;
  transition: background-color 0.15s;
  margin: 0 0.125rem;
}

.aside-marker:hover {
  background-color: rgb(var(--color-aside-marker) / 0.25);
}

.aside-marker-number {
  line-height: 1;
}

/* Aside Content - Hidden on mobile by default */
.aside-content {
  display: none;
}

/* Aside Content - Expanded state on mobile */
.aside-content-expanded {
  display: block;
  background-color: rgb(var(--color-aside-bg));
  border-left: 3px solid rgb(var(--color-aside-border));
  padding: 0.75rem 1rem;
  margin: 0.5rem 0;
  font-size: 0.875rem;
  border-radius: 0 0.25rem 0.25rem 0;
}

.aside-content-inner {
  display: block;
}

.aside-content-number {
  font-weight: 700;
  color: rgb(var(--color-aside-marker));
  margin-right: 0.25rem;
}

/* Desktop: Position asides in right margin */
@media (min-width: 1024px) {
  .article-with-asides {
    position: relative;
  }

  .aside-marker-wrapper {
    display: inline;
  }

  .aside-marker {
    cursor: pointer;
  }

  /* Show content absolutely positioned on desktop */
  .aside-content {
    display: block;
    position: absolute;
    left: calc(100% + 2.5rem);
    width: 200px;
    background-color: rgb(var(--color-aside-bg));
    border-left: 2px solid rgb(var(--color-aside-border));
    padding: 0.5rem 0.75rem;
    font-size: 0.8rem;
    line-height: 1.4;
    border-radius: 0 0.25rem 0.25rem 0;
    z-index: 30;
  }

  /* Reset expanded styles on desktop */
  .aside-content-expanded {
    margin: 0;
  }
}

/* Code-linked asides (asides with id, linked from code blocks) */
.aside-code-linked {
  display: block !important;
}

/* On mobile, code-linked asides show their content directly */
.aside-content-code-linked {
  display: block;
  background-color: rgb(var(--color-aside-bg));
  border-left: 3px solid rgb(var(--color-aside-border));
  padding: 0.75rem 1rem;
  margin: 0.5rem 0;
  font-size: 0.875rem;
  border-radius: 0 0.25rem 0.25rem 0;
}

@media (min-width: 1024px) {
  /* On desktop, code-linked asides are positioned by JS based on code marker location */
  .aside-content-code-linked {
    margin: 0;
  }
}

/* Code Aside Markers */
.code-aside-marker {
  color: rgb(var(--color-aside-marker));
  background-color: rgb(var(--color-aside-marker) / 0.15);
  padding: 0.125rem 0.375rem;
  border-radius: 0.25rem;
  cursor: pointer;
  font-weight: 600;
  transition: background-color 0.15s;
}

.code-aside-marker:hover {
  background-color: rgb(var(--color-aside-marker) / 0.3);
}

/* Highlight animation for aside when targeted from code */
@keyframes aside-highlight {
  0% {
    background-color: rgb(var(--color-aside-marker) / 0.3);
  }
  100% {
    background-color: rgb(var(--color-aside-bg));
  }
}

.aside-content.aside-highlighted {
  animation: aside-highlight 1.5s ease-out;
}
